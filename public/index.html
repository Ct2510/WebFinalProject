<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸŸ æ¼ç”¢åƒ¹æ ¼è®ŠåŒ–æŸ¥è©¢ç³»çµ±</title>
  <meta name="description" content="æŸ¥è©¢æ­·å¹´æ¼ç”¢åƒ¹æ ¼è®ŠåŒ–è¶¨å‹¢ï¼Œæä¾›è©³ç´°çš„åƒ¹æ ¼åˆ†æå’Œåœ–è¡¨å±•ç¤º">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="/stylesheets/style.css"/>
  <!-- Include Chart.js library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Add loading animation -->
  <style>
    .page-loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease;
    }
    .page-loader.hide {
      opacity: 0;
      pointer-events: none;
    }
    .loader-content {
      text-align: center;
      color: white;
    }
    .loader-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255,255,255,0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
  </style>
</head>
<body>

<!-- Page Loader -->
<div class="page-loader" id="pageLoader">
  <div class="loader-content">
    <div class="loader-spinner"></div>
    <h4>ğŸŸ è¼‰å…¥æ¼ç”¢åƒ¹æ ¼ç³»çµ±ä¸­...</h4>
  </div>
</div>

<div class="container py-5">
  <h1 class="mb-4">ğŸŸ æ­·å¹´æ¼ç”¢åƒ¹æ ¼è®ŠåŒ–æŸ¥è©¢ç³»çµ±</h1>

  <!-- Toggle buttons for different modes -->
  <div class="mb-4">
    <div class="btn-group" role="group" aria-label="Mode Selection">
      <button type="button" class="btn btn-outline-primary active" id="queryModeBtn" onclick="switchMode('query')">
        ğŸ“Š æŸ¥è©¢åƒ¹æ ¼
      </button>
      <button type="button" class="btn btn-outline-success" id="addModeBtn" onclick="switchMode('add')">
        â• æ–°å¢åƒ¹æ ¼
      </button>
    </div>
  </div>

  <!-- Query Mode Section -->
  <div id="querySection" class="fade-in">
    <div class="card mb-4">
      <div class="card-header">
        <h4>ğŸ” åƒ¹æ ¼æŸ¥è©¢</h4>
      </div>
      <div class="card-body">
        <!-- Product Selection -->
        <div class="mb-4">
          <label for="productSelect" class="form-label">é¸æ“‡æ¼ç”¢å“ï¼š</label>
          <select id="productSelect" class="form-select" onchange="handleProductChange()" aria-describedby="productHelp">
            <option value="">è«‹é¸æ“‡ç”¢å“</option>
            <!-- Product options will be loaded dynamically -->
          </select>
          <div id="productHelp" class="form-text">é¸æ“‡æ‚¨æƒ³è¦æŸ¥è©¢åƒ¹æ ¼çš„æ¼ç”¢å“</div>
        </div>

        <!-- Year Range Selection -->
        <div class="row mb-4" id="yearSelectionContainer" style="display: none;">
          <div class="col-md-6">
            <label for="startYearSelect" class="form-label">èµ·å§‹å¹´ä»½ï¼š</label>
            <select id="startYearSelect" class="form-select" onchange="handleYearRangeChange()" aria-describedby="startYearHelp">
              <option value="">è«‹é¸æ“‡èµ·å§‹å¹´ä»½</option>
              <!-- Start year options will be loaded dynamically -->
            </select>
            <div id="startYearHelp" class="form-text">é¸æ“‡æŸ¥è©¢çš„èµ·å§‹å¹´ä»½ï¼ˆæ°‘åœ‹å¹´ï¼‰</div>
          </div>
          <div class="col-md-6">
            <label for="endYearSelect" class="form-label">çµæŸå¹´ä»½ï¼š</label>
            <select id="endYearSelect" class="form-select" onchange="handleYearRangeChange()" aria-describedby="endYearHelp">
              <option value="">è«‹é¸æ“‡çµæŸå¹´ä»½</option>
              <!-- End year options will be loaded dynamically -->
            </select>
            <div id="endYearHelp" class="form-text">é¸æ“‡æŸ¥è©¢çš„çµæŸå¹´ä»½ï¼ˆæ°‘åœ‹å¹´ï¼‰</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Mode Section -->
  <div id="addSection" style="display: none;" class="slide-in">
    <div class="card">
      <div class="card-header">
        <h4>â• æ–°å¢æˆ–æ›´æ–°é­šåƒ¹è³‡æ–™</h4>
      </div>
      <div class="card-body">
        <form id="addPriceForm">
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="newProductSelect" class="form-label">ç”¢å“åç¨± <span class="text-danger">*</span></label>
              <select id="newProductSelect" class="form-select" required>
                <option value="">è«‹é¸æ“‡ç”¢å“</option>
                <!-- Product options will be loaded dynamically -->
              </select>
              <div class="form-text">å¾ç¾æœ‰ç”¢å“æ¸…å–®ä¸­é¸æ“‡</div>
            </div>
            <div class="col-md-6">
              <label for="newYear" class="form-label">å¹´ä»½ (æ°‘åœ‹å¹´) <span class="text-danger">*</span></label>
              <input type="number" class="form-control" id="newYear" placeholder="ä¾‹å¦‚ï¼š112" min="100" max="150" required>
              <div class="form-text">è«‹è¼¸å…¥æ°‘åœ‹å¹´ä»½ï¼Œä¾‹å¦‚ï¼š112</div>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="newPrice" class="form-label">åƒ¹æ ¼ <span class="text-danger">*</span></label>
              <input type="number" class="form-control" id="newPrice" placeholder="ä¾‹å¦‚ï¼š94.5" step="0.1" min="0" required>
              <div class="form-text">è«‹è¼¸å…¥æ¯å…¬æ–¤åƒ¹æ ¼</div>
            </div>
            <div class="col-md-6">
              <label for="newUnit" class="form-label">å–®ä½ <span class="text-danger">*</span></label>
              <input type="text" class="form-control" id="newUnit" placeholder="ä¾‹å¦‚ï¼šå…ƒ/å…¬æ–¤" value="å…ƒ/å…¬æ–¤" required>
              <div class="form-text">åƒ¹æ ¼è¨ˆé‡å–®ä½</div>
            </div>
          </div>
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-success btn-lg">
              <span class="me-2">ğŸ’¾</span>æ–°å¢/æ›´æ–°è³‡æ–™
            </button>
          </div>
        </form>
      </div>
    </div>
    
    <!-- Success/Error message area -->
    <div id="messageArea" class="mt-3" style="display: none;">
      <div id="messageContent" class="alert" role="alert"></div>
    </div>
  </div>

  <!-- Data Table -->
  <div id="dataTableContainer" style="display: none;">
    <div class="table-responsive">
      <table class="table table-bordered table-striped">
        <thead class="table-dark">
        <tr>
          <th>ğŸ“… å¹´ä»½</th>
          <th>ğŸŸ ç”¢å“åç¨±</th>
          <th>ğŸ’° å¹³å‡åƒ¹æ ¼</th>
          <th>ğŸ“Š å–®ä½</th>
        </tr>
        </thead>
        <tbody id="priceTableBody">
        <!-- Data will be inserted here -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Price Trend Chart -->
  <div class="mt-5" id="chartContainer" style="display: none;">
    <div class="card">
      <div class="card-header">
        <h3>ğŸ“ˆ åƒ¹æ ¼è¶¨å‹¢åœ–</h3>
      </div>
      <div class="card-body">
        <canvas id="priceChart" width="900" height="450"></canvas>
      </div>
    </div>
  </div>

  <!-- Include Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Include Chart.js library -->
  <script src="/javascripts/script.js"></script>

  <!-- Add page loader script -->
  <script>
    // Hide page loader when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        const loader = document.getElementById('pageLoader');
        if (loader) {
          loader.classList.add('hide');
          setTimeout(() => {
            loader.style.display = 'none';
          }, 500);
        }
      }, 1000);
    });
  </script>
</div>
</body>
</html>